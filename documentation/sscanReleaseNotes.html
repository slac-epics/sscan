<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<title>sscanReleaseNotes</title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">sscan Release Notes</h1>

<h2 align="center">Release 2-5-2</h2>

sscanRecord checks parameters more closely, allows before-scan and after-scan
links to write to selected PV's of their own sscan record
New after-scan action: Move to center of mass of peak (this choice has
problems with multiple positioners, since they won't, in general, have the
same peak position).

In previous versions, recDynLink would deadlock if asked to clear the link
to a PV while an action for that PV was still on queue.  This is fixed.

saveData zeros unused points in its XDR buffer, because XDR doesn't manage
this well.

<h2 align="center">Release 2-4</h2>

This version is intended to build with EPICS base 3.14.7.

<P>Differences from v2.3:
<ul>
<li>The sscan record and saveData now take advantage of the sscan record's
double buffered data arrays, and allow a scan to proceed while the previous
scan's data is being written to disk. (AWAIT, AAWAIT fields)

<li>saveData now runs on Solaris and Linux ioc's.

<li>Array valued detectors are now supported in all scan modes.  Arrays
are read at the end of the scan.  If processing is required to get array
PV's ready, the sscan record can trigger that processing with the A1PV,
A1CD fields (just like detector triggers, but executed after the scan is
done, and just before array PV's are acquired).

<li>The new field DSTATE shows the state of the sscan record's data arrays.
When DSTATE==POSTED, the sscan record can begin a new scan.

<li>Previously, the before-scan and after-scan links always waited for
completion.  Now the user decides, by setting BSWAIT and ASWAIT.

<li>If scan fails limit checks, the scan hangs until user aborts.  Previously,
the scan would appear to complete.

<li>new medm displays for scans are simpler, less cluttered, and have
documentation callups.

<li>In saveData.req (the file in the ioc directory that tells saveData what
scans to monitor, etc), the handshake PV is now ignored.  saveData now
uses scanX.AWAIT to handshake with scanX.

<li>saveData no longer allocates local storage for unused sscan-record 
detectors.  Once a sscan-detector PV is specified, storage is allocated
and never released.

<li>Modified the scanparm record to support multi-dimensional, multiple-
positioner scans: Added two output links to the scanparmRecord: OLOAD, and OGO.  If LOAD
is nonzero, it's written to OLOAD; if GO is nonzero, it's written to OGO.

<li>Added scanParms2Pos.db, scanParms2Pos.adl -- scan parameters for a 1D
scan with two positioners.

<li>The scanparm record now uses long int, rather than short int, for the
number of data points (fields MP and NP).

<li>sscanRecord.dbd and scanparmRecord.dbd now include sscanMenu.dbd, to ensure
that menus are consistent.  Sometime in the past, the scanparm record wasn't
updated when sscanRecord menu fields were modified.  In particular,
scanParm*.db and alignParms.db used to specify "Relative" positioning, while
the sscan record accepted only "RELATIVE" or "ABSOLUTE".

<li>The sscan record now issues recDynLinkGetCallback() for each positioner and
detector PV, and waits for the callback before using the PV value that was cached
by recDynLink. 

<li>Added recDynLinkGetCallback() to recDynLink library.  Also fixed some bugs.  

<li><a href="cvsLog.txt">cvs log</a>

</ul>

<h2 align="center">Release 2-3</h2>

<p align="left">This is the first release of the synApps sscan module.
Version numbering for this module begins with 2.3 because this module
was split from version 2.2 of the std module, and I wanted to retain
the CVS histories of module contents.</p>

This version is intended to build with EPICS base 3.14.5.

Differences from software as previously released in std 2.2:
<ul>
<li><p>Converted to EPICS 3.14.  Currently saveData runs on vxWorks only. 
<li><p>Docs updated and moved to sscan/documentation
<li><p>saveData - added iocsh support; changed number
of data points from short to long int, to support
very large scans.  The data file format is unchanged, however,
because the number of points was already being written as a four-byte
quantity.
<li><p>sscanRecord - Number of points in a scan is essentially limited only by
available memory.  save-restored value of NPTS is now checked against MPTS.
Array mode (ACQT="1D ARRAY") was broken.  (The change from ACQM="ARRAYS" to
ACQT="1D ARRAY" wasn't done correctly.)
<p>Previously, the sscan record's response to an abort request (.EXSC=0) while
no scan was in progress (.BUSY==0) was to return nonzero from special(), and
EPICS tolerated this without comment.  Now it signals an error to the client.
But we don't (always?) want this action to be regarded as an error.  For now,
the scan database just declines to abort a sscan record that isn't busy, but
clients writing directly to the sscan record directly can still get this
error message.
<li><p>recDynLink - Fixed memory leak (epicsMutex created but not destroyed).
Switched communication with link tasks from ring buffer to message queue.
recDynOut was calling ca_pend_event, which used to flush the ca buffer, but
evidently no longer does; replaced with ca_flush_io.
<li><p>saveData_settings.req - new file.
<li><p>scan_settings.req - added fields ACQT and ACQM.
</ul>
<address>
    Suggestions and Comments to: <br>
    <a href="mailto:mooney@aps.anl.gov">Tim Mooney </a>:
    (mooney@aps.anl.gov) <br>
    Last modified: August 8, 2004 
</address>
</body>
</html>
